#!/bin/bash
set -euo pipefail

# Verify standort works.
curl -sf http://localhost:3000/v1/location/ip/95.91.246.242 | grep '"continent":"EU"'
curl -sf http://localhost:3000/v1/location/lat/52.515816/lng/13.454293 | grep '"continent":"EU"'
curl -sf "http://localhost:3000/v2/location?point.lat=52.515816&point.lng=13.454293" | grep '"continent":"EU"'

# Verify konfig works.
curl -sf http://localhost:4000/v1/config/test/v1.9.0/staging/eu/de/server/yaml | grep '"version":"v1.9.0"'
curl -sf http://localhost:4000/v1/config/test/v1.9.0/staging/eu/de/server/toml | grep '"version":"v1.9.0"'

# Verify bezeichner works.
curl -sf http://localhost:2000/v1/generate/snowflake/2 | grep 'ids'
curl -sf http://localhost:2000/v1/generate/ulid/2 | grep 'ids'
curl -sf http://localhost:2000/v1/generate/xid/2 | grep 'ids'
curl -sf http://localhost:2000/v1/generate/nanoid/2 | grep 'ids'

# Verify auth works.
curl -sf -H "Authorization: Basic c3UtMTIzNDpNQ1p4TCRZNWJleXBBV2o8SlFFTmZ0QFBfRFhWdWgjLF0wMnJxMUh3ZDY5bUZnKFJ8N2NpJlRsYW9CVThrM3M0" --data-raw '{}' http://localhost:5000/v1/access-token/generate | grep 'bearer'
curl -sf -H "Authorization: Bearer PE7+1MdFLPkwb3BCTEYxesCsd96bb+3cfZbObbijWOsQ39HtvlQE9TuptDrurWOeD4gjhxzP1eGEF7A8CE9ddL1gUeulvWYJ16MKog+Rosbsxk3dze5j1yxhRiMzhH4bIe4MvCHdi2NPIRbT7qQcjBHr04KuHjO2qYya398kMuFq5Xezpl1uvv7idcpPQmgT6vKzFH14hVFR1R1S1ABCe7x2Fwxl6xDjaetoJ7vrpVwwbqOLl79L5U98QGyAHVE1kxEkursPQBGa7rb3s0LHAQCJOxS6daeV6Xkbd/y4rC2L+65xfB2FAMZtvg+bX+Tr6S4EyQyQt0GfJvX/8cNy6TN21UG73FNEk3TYIz46JAhRaGk2Atn4+AO35Ypz75ovZghn8snAkSSNjeZMnTFKf0uNIS6W/xULZcaZnxYKYwwjxsTwGsM/H97n2YqbaEOzG4fU69mJsz0KwA/2TE1aqhb5Hpf2GbJVxoN7AkNp6kRmmufMssZluXC5Xd+bKSrNsK2yzxAgPrV7X/xIfqeJZ653Vp6HevN7G41jQuXBXcgn4nnubnf+f/3CyvBpIcwm9OoVFFgb0C60nZFMmSex/yc6EwaRP+9EEESztCzX+W9kN0fNHCnq2+rYsVfc4wZVlQq0aRgtl1k9umGI1ikjGwWaJ8uwmxSOJHPyg6xFmDo=" --data-raw '{}' http://localhost:5000/v1/service-token/generate | grep 'bearer'
